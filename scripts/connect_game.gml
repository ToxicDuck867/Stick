global.udpsock=udpconnect(CLIENT_UDP,true);if (global.udpsock<=0){  add_menu_error("Failed to open port (UDP)");  return (false);}global.gamesock=tcpconnect(IP_ADDRESS,TCP1,true);if (global.gamesock<=0){  closesocket(global.udpsock);  add_menu_error("Failed to connect to server (TCP Game)");  return (false);}setnagle(global.gamesock,true);_time=current_time+30000;_received=false;_done=false;while ((_time>current_time) and (_done==false)){  size=receivemessage(global.gamesock);  if (size>=0)  {    if (size==0)    {      show_message("Connection closed by server");      closesocket(global.udpsock);      game_end();      return (false);    }    global.myid=readushort();    _received=true;    _done=true;  }}if (_received==false){  closesocket(global.udpsock);  add_menu_error("Connection failed (no response from server)");  return (false);}return (true);